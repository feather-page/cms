<div class="mb-3"
     data-controller="header-image-picker"
     data-header-image-picker-search-url-value="<%= search_url %>"
     data-header-image-picker-create-url-value="<%= create_url %>"
     data-header-image-picker-upload-url-value="<%= upload_url %>">

  <%= form.hidden_field attribute %>
  <%= form.hidden_field emoji_attribute, data: { header_image_picker_target: "emojiInput" } %>

  <!-- Notion-style Preview -->
  <div data-header-image-picker-target="preview" class="header-preview mb-3" style="<%= 'display: none;' unless current_image || current_emoji.present? %>">
    <div class="header-preview-image" data-header-image-picker-target="imageContainer" style="<%= 'display: none;' unless current_image %>">
      <% if current_image %>
        <%= image_tag current_image.file %>
      <% end %>
    </div>
    <% if current_emoji.present? %>
      <button type="button"
              class="header-preview-emoji"
              data-header-image-picker-target="emojiDisplay"
              data-action="header-image-picker#openEmojiPicker"
              title="Click to change icon"><%= current_emoji %></button>
    <% else %>
      <span class="header-preview-emoji" data-header-image-picker-target="emojiDisplay" style="display: none;"></span>
    <% end %>
  </div>

  <!-- Action Buttons -->
  <div class="d-flex gap-2 flex-wrap mb-3 position-relative">
    <div class="btn-group" role="group">
      <button type="button"
              class="btn btn-outline-secondary btn-sm"
              data-action="header-image-picker#openEmojiPicker"
              data-header-image-picker-target="addIconButton">
        ðŸ˜€ Add icon
      </button>

      <button type="button"
              class="btn btn-outline-secondary btn-sm"
              data-action="header-image-picker#openUnsplashModal">
        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" class="bi bi-image me-1" viewBox="0 0 16 16">
          <path d="M6.002 5.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0"/>
          <path d="M2.002 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2zm12 1a1 1 0 0 1 1 1v6.5l-3.777-1.947a.5.5 0 0 0-.577.093l-3.71 3.71-2.66-1.772a.5.5 0 0 0-.63.062L1.002 12V3a1 1 0 0 1 1-1z"/>
        </svg>
        Cover
      </button>

      <button type="button"
              class="btn btn-outline-secondary btn-sm"
              data-action="header-image-picker#openUploadModal">
        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" class="bi bi-upload me-1" viewBox="0 0 16 16">
          <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5"/>
          <path d="M7.646 1.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 2.707V11.5a.5.5 0 0 1-1 0V2.707L5.354 4.854a.5.5 0 1 1-.708-.708z"/>
        </svg>
        Upload
      </button>

      <button type="button"
              class="btn btn-outline-danger btn-sm"
              data-action="header-image-picker#removeEmoji"
              data-header-image-picker-target="removeEmojiButton"
              style="<%= 'display: none;' unless current_emoji.present? %>">
        Remove icon
      </button>

      <button type="button"
              class="btn btn-outline-danger btn-sm"
              data-action="header-image-picker#remove"
              data-header-image-picker-target="removeButton"
              style="<%= 'display: none;' unless current_image %>">
        Remove cover
      </button>
    </div>

    <!-- Emoji Picker Popover -->
    <div data-header-image-picker-target="emojiPicker" class="emoji-picker" style="display: none;">
      <div class="emoji-picker-scroll">
        <% {
          "Smileys" => %w[ðŸ˜€ ðŸ˜ƒ ðŸ˜„ ðŸ˜ ðŸ˜† ðŸ˜… ðŸ¤£ ðŸ˜‚ ðŸ™‚ ðŸ™ƒ ðŸ˜‰ ðŸ˜Š ðŸ˜‡ ðŸ¥° ðŸ˜ ðŸ¤© ðŸ˜˜ ðŸ˜— ðŸ˜š ðŸ˜™ ðŸ¥² ðŸ˜‹ ðŸ˜› ðŸ˜œ ðŸ¤ª ðŸ˜ ðŸ¤‘ ðŸ¤— ðŸ¤­ ðŸ¤« ðŸ¤” ðŸ¤ ðŸ¤¨ ðŸ˜ ðŸ˜‘ ðŸ˜¶ ðŸ˜ ðŸ˜’ ðŸ™„ ðŸ˜¬ ðŸ¤¥ ðŸ˜Œ ðŸ˜” ðŸ˜ª ðŸ¤¤ ðŸ˜´ ðŸ˜· ðŸ¤’ ðŸ¤• ðŸ¤¢ ðŸ¤® ðŸ¤§ ðŸ¥µ ðŸ¥¶ ðŸ¥´ ðŸ˜µ ðŸ¤¯ ðŸ¤  ðŸ¥³ ðŸ¥¸ ðŸ˜Ž ðŸ¤“ ðŸ§ ðŸ˜• ðŸ˜Ÿ ðŸ™ â˜¹ï¸ ðŸ˜® ðŸ˜¯ ðŸ˜² ðŸ˜³ ðŸ¥º ðŸ˜¦ ðŸ˜§ ðŸ˜¨ ðŸ˜° ðŸ˜¥ ðŸ˜¢ ðŸ˜­ ðŸ˜± ðŸ˜– ðŸ˜£ ðŸ˜ž ðŸ˜“ ðŸ˜© ðŸ˜« ðŸ¥± ðŸ˜¤ ðŸ˜¡ ðŸ˜  ðŸ¤¬ ðŸ˜ˆ ðŸ‘¿ ðŸ’€ â˜ ï¸ ðŸ’© ðŸ¤¡ ðŸ‘¹ ðŸ‘º ðŸ‘» ðŸ‘½ ðŸ‘¾ ðŸ¤–],
          "Gestures" => %w[ðŸ‘‹ ðŸ¤š ðŸ– âœ‹ ðŸ–– ðŸ‘Œ ðŸ¤Œ ðŸ¤ âœŒï¸ ðŸ¤ž ðŸ¤Ÿ ðŸ¤˜ ðŸ¤™ ðŸ‘ˆ ðŸ‘‰ ðŸ‘† ðŸ–• ðŸ‘‡ â˜ï¸ ðŸ‘ ðŸ‘Ž âœŠ ðŸ‘Š ðŸ¤› ðŸ¤œ ðŸ‘ ðŸ™Œ ðŸ‘ ðŸ¤² ðŸ¤ ðŸ™ âœï¸ ðŸ’… ðŸ¤³ ðŸ’ª ðŸ¦¾ ðŸ¦¿ ðŸ¦µ ðŸ¦¶ ðŸ‘‚ ðŸ¦» ðŸ‘ƒ ðŸ§  ðŸ«€ ðŸ« ðŸ¦· ðŸ¦´ ðŸ‘€ ðŸ‘ ðŸ‘… ðŸ‘„],
          "People" => %w[ðŸ‘¶ ðŸ§’ ðŸ‘¦ ðŸ‘§ ðŸ§‘ ðŸ‘± ðŸ‘¨ ðŸ§” ðŸ‘© ðŸ§“ ðŸ‘´ ðŸ‘µ ðŸ™ ðŸ™Ž ðŸ™… ðŸ™† ðŸ’ ðŸ™‹ ðŸ§ ðŸ™‡ ðŸ¤¦ ðŸ¤· ðŸ‘® ðŸ•µ ðŸ’‚ ðŸ¥· ðŸ‘· ðŸ¤´ ðŸ‘¸ ðŸ‘³ ðŸ‘² ðŸ§• ðŸ¤µ ðŸ‘° ðŸ¤° ðŸ¤± ðŸ‘¼ ðŸŽ… ðŸ¤¶ ðŸ¦¸ ðŸ¦¹ ðŸ§™ ðŸ§š ðŸ§› ðŸ§œ ðŸ§ ðŸ§ž ðŸ§Ÿ ðŸ’† ðŸ’‡ ðŸš¶ ðŸ§ ðŸ§Ž ðŸƒ ðŸ’ƒ ðŸ•º ðŸ‘¯ ðŸ§– ðŸ§— ðŸ¤¸ ðŸŒ ðŸ‡ â›· ðŸ‚ ðŸ‹ ðŸ¤¼ ðŸ¤½ ðŸ¤¾ ðŸ¤º â›¹ ðŸŠ ðŸš£ ðŸ§˜ ðŸ›€ ðŸ›Œ],
          "Animals" => %w[ðŸ¶ ðŸ± ðŸ­ ðŸ¹ ðŸ° ðŸ¦Š ðŸ» ðŸ¼ ðŸ»â€â„ï¸ ðŸ¨ ðŸ¯ ðŸ¦ ðŸ® ðŸ· ðŸ½ ðŸ¸ ðŸµ ðŸ™ˆ ðŸ™‰ ðŸ™Š ðŸ’ ðŸ” ðŸ§ ðŸ¦ ðŸ¤ ðŸ£ ðŸ¥ ðŸ¦† ðŸ¦… ðŸ¦‰ ðŸ¦‡ ðŸº ðŸ— ðŸ´ ðŸ¦„ ðŸ ðŸª± ðŸ› ðŸ¦‹ ðŸŒ ðŸž ðŸœ ðŸª° ðŸª² ðŸª³ ðŸ¦Ÿ ðŸ¦— ðŸ•· ðŸ•¸ ðŸ¦‚ ðŸ¢ ðŸ ðŸ¦Ž ðŸ¦– ðŸ¦• ðŸ™ ðŸ¦‘ ðŸ¦ ðŸ¦ž ðŸ¦€ ðŸ¡ ðŸ  ðŸŸ ðŸ¬ ðŸ³ ðŸ‹ ðŸ¦ˆ ðŸŠ ðŸ… ðŸ† ðŸ¦“ ðŸ¦ ðŸ¦§ ðŸ¦£ ðŸ˜ ðŸ¦› ðŸ¦ ðŸª ðŸ« ðŸ¦’ ðŸ¦˜ ðŸ¦¬ ðŸƒ ðŸ‚ ðŸ„ ðŸŽ ðŸ– ðŸ ðŸ‘ ðŸ¦™ ðŸ ðŸ¦Œ ðŸ• ðŸ© ðŸ¦® ðŸ•â€ðŸ¦º ðŸˆ ðŸˆâ€â¬› ðŸª¶ ðŸ“ ðŸ¦ƒ ðŸ¦¤ ðŸ¦š ðŸ¦œ ðŸ¦¢ ðŸ¦© ðŸ•Š ðŸ‡ ðŸ¦ ðŸ¦¨ ðŸ¦¡ ðŸ¦« ðŸ¦¦ ðŸ¦¥ ðŸ ðŸ€ ðŸ¿ ðŸ¦”],
          "Nature" => %w[ðŸŒµ ðŸŽ„ ðŸŒ² ðŸŒ³ ðŸŒ´ ðŸªµ ðŸŒ± ðŸŒ¿ â˜˜ï¸ ðŸ€ ðŸŽ ðŸª´ ðŸŽ‹ ðŸƒ ðŸ‚ ðŸ ðŸ„ ðŸš ðŸª¨ ðŸŒ¾ ðŸ’ ðŸŒ· ðŸŒ¹ ðŸ¥€ ðŸŒº ðŸŒ¸ ðŸŒ¼ ðŸŒ» ðŸŒž ðŸŒ ðŸŒ› ðŸŒœ ðŸŒš ðŸŒ• ðŸŒ– ðŸŒ— ðŸŒ˜ ðŸŒ‘ ðŸŒ’ ðŸŒ“ ðŸŒ” ðŸŒ™ ðŸŒŽ ðŸŒ ðŸŒ ðŸª ðŸ’« â­ ðŸŒŸ âœ¨ âš¡ â˜„ï¸ ðŸ’¥ ðŸ”¥ ðŸŒª ðŸŒˆ â˜€ï¸ ðŸŒ¤ â›… ðŸŒ¥ â˜ï¸ ðŸŒ¦ ðŸŒ§ â›ˆ ðŸŒ© ðŸŒ¨ â„ï¸ â˜ƒï¸ â›„ ðŸŒ¬ ðŸ’¨ ðŸ’§ ðŸ’¦ â˜” â˜‚ï¸ ðŸŒŠ ðŸŒ«],
          "Food" => %w[ðŸ ðŸŽ ðŸ ðŸŠ ðŸ‹ ðŸŒ ðŸ‰ ðŸ‡ ðŸ“ ðŸ« ðŸˆ ðŸ’ ðŸ‘ ðŸ¥­ ðŸ ðŸ¥¥ ðŸ¥ ðŸ… ðŸ† ðŸ¥‘ ðŸ¥¦ ðŸ¥¬ ðŸ¥’ ðŸŒ¶ ðŸ«‘ ðŸŒ½ ðŸ¥• ðŸ«’ ðŸ§„ ðŸ§… ðŸ¥” ðŸ  ðŸ¥ ðŸ¥¯ ðŸž ðŸ¥– ðŸ¥¨ ðŸ§€ ðŸ¥š ðŸ³ ðŸ§ˆ ðŸ¥ž ðŸ§‡ ðŸ¥“ ðŸ¥© ðŸ— ðŸ– ðŸ¦´ ðŸŒ­ ðŸ” ðŸŸ ðŸ• ðŸ«“ ðŸ¥ª ðŸ¥™ ðŸ§† ðŸŒ® ðŸŒ¯ ðŸ«” ðŸ¥— ðŸ¥˜ ðŸ«• ðŸ¥« ðŸ ðŸœ ðŸ² ðŸ› ðŸ£ ðŸ± ðŸ¥Ÿ ðŸ¦ª ðŸ¤ ðŸ™ ðŸš ðŸ˜ ðŸ¥ ðŸ¥  ðŸ¥® ðŸ¢ ðŸ¡ ðŸ§ ðŸ¨ ðŸ¦ ðŸ¥§ ðŸ§ ðŸ° ðŸŽ‚ ðŸ® ðŸ­ ðŸ¬ ðŸ« ðŸ¿ ðŸ© ðŸª ðŸŒ° ðŸ¥œ ðŸ¯ ðŸ¥› ðŸ¼ ðŸ«– â˜• ðŸµ ðŸ§ƒ ðŸ¥¤ ðŸ§‹ ðŸ¶ ðŸº ðŸ» ðŸ¥‚ ðŸ· ðŸ¥ƒ ðŸ¸ ðŸ¹ ðŸ§‰ ðŸ¾ ðŸ§Š ðŸ¥„ ðŸ´ ðŸ½ ðŸ¥£ ðŸ¥¡ ðŸ¥¢ ðŸ§‚],
          "Activities" => %w[âš½ ðŸ€ ðŸˆ âš¾ ðŸ¥Ž ðŸŽ¾ ðŸ ðŸ‰ ðŸ¥ ðŸŽ± ðŸª€ ðŸ“ ðŸ¸ ðŸ’ ðŸ‘ ðŸ¥ ðŸ ðŸªƒ ðŸ¥… â›³ ðŸª ðŸ¹ ðŸŽ£ ðŸ¤¿ ðŸ¥Š ðŸ¥‹ ðŸŽ½ ðŸ›¹ ðŸ›¼ ðŸ›· â›¸ ðŸ¥Œ ðŸŽ¿ â›· ðŸ‚ ðŸª‚ ðŸ‹ ðŸ¤¼ ðŸ¤¸ ðŸ¤º â›¹ ðŸ¤¾ ðŸŒ ðŸ‡ ðŸ§˜ ðŸ„ ðŸŠ ðŸ¤½ ðŸš£ ðŸ§— ðŸšµ ðŸš´ ðŸ† ðŸ¥‡ ðŸ¥ˆ ðŸ¥‰ ðŸ… ðŸŽ– ðŸµ ðŸŽ— ðŸŽ« ðŸŽŸ ðŸŽª ðŸ¤¹ ðŸŽ­ ðŸ©° ðŸŽ¨ ðŸŽ¬ ðŸŽ¤ ðŸŽ§ ðŸŽ¼ ðŸŽ¹ ðŸ¥ ðŸª˜ ðŸŽ· ðŸŽº ðŸŽ¸ ðŸª• ðŸŽ» ðŸª— ðŸŽ² â™Ÿ ðŸŽ¯ ðŸŽ³ ðŸŽ® ðŸŽ° ðŸ§©],
          "Travel" => %w[ðŸš— ðŸš• ðŸš™ ðŸšŒ ðŸšŽ ðŸŽ ðŸš“ ðŸš‘ ðŸš’ ðŸš ðŸ›» ðŸšš ðŸš› ðŸšœ ðŸ¦¯ ðŸ¦½ ðŸ¦¼ ðŸ›´ ðŸš² ðŸ›µ ðŸ ðŸ›º ðŸš¨ ðŸš” ðŸš ðŸš˜ ðŸš– ðŸš¡ ðŸš  ðŸšŸ ðŸšƒ ðŸš‹ ðŸšž ðŸš ðŸš„ ðŸš… ðŸšˆ ðŸš‚ ðŸš† ðŸš‡ ðŸšŠ ðŸš‰ âœˆï¸ ðŸ›« ðŸ›¬ ðŸ›© ðŸ’º ðŸ›° ðŸš€ ðŸ›¸ ðŸš ðŸ›¶ â›µ ðŸš¤ ðŸ›¥ ðŸ›³ â›´ ðŸš¢ âš“ ðŸª â›½ ðŸš§ ðŸš¦ ðŸš¥ ðŸš ðŸ—º ðŸ—¿ ðŸ—½ ðŸ—¼ ðŸ° ðŸ¯ ðŸŸ ðŸŽ¡ ðŸŽ¢ ðŸŽ  â›² â›± ðŸ– ðŸ ðŸœ ðŸŒ‹ â›° ðŸ” ðŸ—» ðŸ• â›º ðŸ›– ðŸ  ðŸ¡ ðŸ˜ ðŸš ðŸ— ðŸ­ ðŸ¢ ðŸ¬ ðŸ£ ðŸ¤ ðŸ¥ ðŸ¦ ðŸ¨ ðŸª ðŸ« ðŸ© ðŸ’’ ðŸ› â›ª ðŸ•Œ ðŸ• ðŸ›• ðŸ•‹ â›© ðŸ›¤ ðŸ›£ ðŸ—¾ ðŸŽ‘ ðŸž ðŸŒ… ðŸŒ„ ðŸŒ  ðŸŽ‡ ðŸŽ† ðŸŒ‡ ðŸŒ† ðŸ™ ðŸŒƒ ðŸŒŒ ðŸŒ‰ ðŸŒ],
          "Objects" => %w[âŒš ðŸ“± ðŸ“² ðŸ’» âŒ¨ï¸ ðŸ–¥ ðŸ–¨ ðŸ–± ðŸ–² ðŸ•¹ ðŸ—œ ðŸ’½ ðŸ’¾ ðŸ’¿ ðŸ“€ ðŸ“¼ ðŸ“· ðŸ“¸ ðŸ“¹ ðŸŽ¥ ðŸ“½ ðŸŽž ðŸ“ž â˜Žï¸ ðŸ“Ÿ ðŸ“  ðŸ“º ðŸ“» ðŸŽ™ ðŸŽš ðŸŽ› ðŸ§­ â± â² â° ðŸ•° âŒ› â³ ðŸ“¡ ðŸ”‹ ðŸ”Œ ðŸ’¡ ðŸ”¦ ðŸ•¯ ðŸª” ðŸ§¯ ðŸ›¢ ðŸ’¸ ðŸ’µ ðŸ’´ ðŸ’¶ ðŸ’· ðŸª™ ðŸ’° ðŸ’³ ðŸ’Ž âš–ï¸ ðŸªœ ðŸ§° ðŸª› ðŸ”§ ðŸ”¨ âš’ ðŸ›  â› ðŸªš ðŸ”© âš™ï¸ ðŸª¤ ðŸ§± â›“ ðŸ§² ðŸ”« ðŸ’£ ðŸ§¨ ðŸª“ ðŸ”ª ðŸ—¡ âš”ï¸ ðŸ›¡ ðŸš¬ âš°ï¸ ðŸª¦ âš±ï¸ ðŸº ðŸ”® ðŸ“¿ ðŸ§¿ ðŸ’ˆ âš—ï¸ ðŸ”­ ðŸ”¬ ðŸ•³ ðŸ©¹ ðŸ©º ðŸ’Š ðŸ’‰ ðŸ©¸ ðŸ§¬ ðŸ¦  ðŸ§« ðŸ§ª ðŸŒ¡ ðŸ§¹ ðŸª  ðŸ§º ðŸ§» ðŸš½ ðŸš° ðŸš¿ ðŸ› ðŸ›€ ðŸ§¼ ðŸª¥ ðŸª’ ðŸ§½ ðŸª£ ðŸ§´ ðŸ›Ž ðŸ”‘ ðŸ— ðŸšª ðŸª‘ ðŸ›‹ ðŸ› ðŸ›Œ ðŸ§¸ ðŸª† ðŸ–¼ ðŸªž ðŸªŸ ðŸ› ðŸ›’ ðŸŽ ðŸŽˆ ðŸŽ ðŸŽ€ ðŸª„ ðŸª… ðŸŽŠ ðŸŽ‰ ðŸŽŽ ðŸ® ðŸŽ ðŸ§§ âœ‰ï¸ ðŸ“© ðŸ“¨ ðŸ“§ ðŸ’Œ ðŸ“¥ ðŸ“¤ ðŸ“¦ ðŸ· ðŸª§ ðŸ“ª ðŸ“« ðŸ“¬ ðŸ“­ ðŸ“® ðŸ“¯ ðŸ“œ ðŸ“ƒ ðŸ“„ ðŸ“‘ ðŸ§¾ ðŸ“Š ðŸ“ˆ ðŸ“‰ ðŸ—’ ðŸ—“ ðŸ“† ðŸ“… ðŸ—‘ ðŸ“‡ ðŸ—ƒ ðŸ—³ ðŸ—„ ðŸ“‹ ðŸ“ ðŸ“‚ ðŸ—‚ ðŸ—ž ðŸ“° ðŸ““ ðŸ“” ðŸ“’ ðŸ“• ðŸ“— ðŸ“˜ ðŸ“™ ðŸ“š ðŸ“– ðŸ”– ðŸ§· ðŸ”— ðŸ“Ž ðŸ–‡ ðŸ“ ðŸ“ ðŸ§® ðŸ“Œ ðŸ“ âœ‚ï¸ ðŸ–Š ðŸ–‹ âœ’ï¸ ðŸ–Œ ðŸ– ðŸ“ âœï¸ ðŸ” ðŸ”Ž ðŸ” ðŸ” ðŸ”’ ðŸ”“],
          "Symbols" => %w[â¤ï¸ ðŸ§¡ ðŸ’› ðŸ’š ðŸ’™ ðŸ’œ ðŸ–¤ ðŸ¤ ðŸ¤Ž ðŸ’” â£ï¸ ðŸ’• ðŸ’ž ðŸ’“ ðŸ’— ðŸ’– ðŸ’˜ ðŸ’ ðŸ’Ÿ â˜®ï¸ âœï¸ â˜ªï¸ ðŸ•‰ â˜¸ï¸ âœ¡ï¸ ðŸ”¯ ðŸ•Ž â˜¯ï¸ â˜¦ï¸ ðŸ› â›Ž â™ˆ â™‰ â™Š â™‹ â™Œ â™ â™Ž â™ â™ â™‘ â™’ â™“ ðŸ†” âš›ï¸ ðŸ‰‘ â˜¢ï¸ â˜£ï¸ ðŸ“´ ðŸ“³ ðŸˆ¶ ðŸˆš ðŸˆ¸ ðŸˆº ðŸˆ·ï¸ âœ´ï¸ ðŸ†š ðŸ’® ðŸ‰ ãŠ™ï¸ ãŠ—ï¸ ðŸˆ´ ðŸˆµ ðŸˆ¹ ðŸˆ² ðŸ…°ï¸ ðŸ…±ï¸ ðŸ†Ž ðŸ†‘ ðŸ…¾ï¸ ðŸ†˜ âŒ â­• ðŸ›‘ â›” ðŸ“› ðŸš« ðŸ’¯ ðŸ’¢ â™¨ï¸ ðŸš· ðŸš¯ ðŸš³ ðŸš± ðŸ”ž ðŸ“µ ðŸš­ â— â• â“ â” â€¼ï¸ â‰ï¸ ðŸ”… ðŸ”† ã€½ï¸ âš ï¸ ðŸš¸ ðŸ”± âšœï¸ ðŸ”° â™»ï¸ âœ… ðŸˆ¯ ðŸ’¹ â‡ï¸ âœ³ï¸ âŽ ðŸŒ ðŸ’  â“‚ï¸ ðŸŒ€ ðŸ’¤ ðŸ§ ðŸš¾ â™¿ ðŸ…¿ï¸ ðŸ›— ðŸˆ³ ðŸˆ‚ï¸ ðŸ›‚ ðŸ›ƒ ðŸ›„ ðŸ›… ðŸš¹ ðŸšº ðŸš¼ âš§ ðŸš» ðŸš® ðŸŽ¦ ðŸ“¶ ðŸˆ ðŸ”£ â„¹ï¸ ðŸ”¤ ðŸ”¡ ðŸ”  ðŸ†– ðŸ†— ðŸ†™ ðŸ†’ ðŸ†• ðŸ†“ 0ï¸âƒ£ 1ï¸âƒ£ 2ï¸âƒ£ 3ï¸âƒ£ 4ï¸âƒ£ 5ï¸âƒ£ 6ï¸âƒ£ 7ï¸âƒ£ 8ï¸âƒ£ 9ï¸âƒ£ ðŸ”Ÿ ðŸ”¢ #ï¸âƒ£ *ï¸âƒ£ âï¸ â–¶ï¸ â¸ â¯ â¹ âº â­ â® â© âª â« â¬ â—€ï¸ ðŸ”¼ ðŸ”½ âž¡ï¸ â¬…ï¸ â¬†ï¸ â¬‡ï¸ â†—ï¸ â†˜ï¸ â†™ï¸ â†–ï¸ â†•ï¸ â†”ï¸ â†ªï¸ â†©ï¸ â¤´ï¸ â¤µï¸ ðŸ”€ ðŸ” ðŸ”‚ ðŸ”„ ðŸ”ƒ ðŸŽµ ðŸŽ¶ âž• âž– âž— âœ–ï¸ â™¾ ðŸ’² ðŸ’± â„¢ï¸ Â©ï¸ Â®ï¸ ã€°ï¸ âž° âž¿ ðŸ”š ðŸ”™ ðŸ”› ðŸ” ðŸ”œ âœ”ï¸ â˜‘ï¸ ðŸ”˜ ðŸ”´ ðŸŸ  ðŸŸ¡ ðŸŸ¢ ðŸ”µ ðŸŸ£ âš« âšª ðŸŸ¤ ðŸ”º ðŸ”» ðŸ”¸ ðŸ”¹ ðŸ”¶ ðŸ”· ðŸ”³ ðŸ”² â–ªï¸ â–«ï¸ â—¾ â—½ â—¼ï¸ â—»ï¸ ðŸŸ¥ ðŸŸ§ ðŸŸ¨ ðŸŸ© ðŸŸ¦ ðŸŸª â¬› â¬œ ðŸŸ« ðŸ”ˆ ðŸ”‡ ðŸ”‰ ðŸ”Š ðŸ”” ðŸ”• ðŸ“£ ðŸ“¢ ðŸ‘â€ðŸ—¨ ðŸ’¬ ðŸ’­ ðŸ—¯ â™ ï¸ â™£ï¸ â™¥ï¸ â™¦ï¸ ðŸƒ ðŸŽ´ ðŸ€„ ðŸ• ðŸ•‘ ðŸ•’ ðŸ•“ ðŸ•” ðŸ•• ðŸ•– ðŸ•— ðŸ•˜ ðŸ•™ ðŸ•š ðŸ•› ðŸ•œ ðŸ• ðŸ•ž ðŸ•Ÿ ðŸ•  ðŸ•¡ ðŸ•¢ ðŸ•£ ðŸ•¤ ðŸ•¥ ðŸ•¦ ðŸ•§],
          "Flags" => %w[ðŸ³ï¸ ðŸ´ ðŸ´â€â˜ ï¸ ðŸ ðŸš© ðŸŽŒ ðŸ‡©ðŸ‡ª ðŸ‡¦ðŸ‡¹ ðŸ‡¨ðŸ‡­ ðŸ‡ºðŸ‡¸ ðŸ‡¬ðŸ‡§ ðŸ‡«ðŸ‡· ðŸ‡ªðŸ‡¸ ðŸ‡®ðŸ‡¹ ðŸ‡¯ðŸ‡µ ðŸ‡¨ðŸ‡³ ðŸ‡°ðŸ‡· ðŸ‡·ðŸ‡º ðŸ‡§ðŸ‡· ðŸ‡®ðŸ‡³ ðŸ‡¦ðŸ‡º ðŸ‡¨ðŸ‡¦ ðŸ‡²ðŸ‡½ ðŸ‡³ðŸ‡± ðŸ‡§ðŸ‡ª ðŸ‡¸ðŸ‡ª ðŸ‡³ðŸ‡´ ðŸ‡©ðŸ‡° ðŸ‡«ðŸ‡® ðŸ‡µðŸ‡± ðŸ‡ºðŸ‡¦ ðŸ‡¹ðŸ‡· ðŸ‡¬ðŸ‡· ðŸ‡µðŸ‡¹ ðŸ‡®ðŸ‡ª ðŸ‡¿ðŸ‡¦ ðŸ‡ªðŸ‡¬ ðŸ‡³ðŸ‡¬ ðŸ‡°ðŸ‡ª ðŸ‡¦ðŸ‡· ðŸ‡¨ðŸ‡± ðŸ‡¨ðŸ‡´ ðŸ‡µðŸ‡ª ðŸ‡»ðŸ‡ª ðŸ‡¹ðŸ‡­ ðŸ‡»ðŸ‡³ ðŸ‡®ðŸ‡© ðŸ‡µðŸ‡­ ðŸ‡²ðŸ‡¾ ðŸ‡¸ðŸ‡¬ ðŸ‡³ðŸ‡¿ ðŸ‡®ðŸ‡± ðŸ‡¸ðŸ‡¦ ðŸ‡¦ðŸ‡ª ðŸ‡¶ðŸ‡¦ ðŸ‡ªðŸ‡º]
        }.each do |category, emojis| %>
          <div class="emoji-category">
            <div class="emoji-category-label"><%= category %></div>
            <div class="emoji-picker-grid">
              <% emojis.each do |emoji| %>
                <button type="button"
                        class="emoji-option"
                        data-action="header-image-picker#selectEmoji"
                        data-emoji="<%= emoji %>"><%= emoji %></button>
              <% end %>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  </div>

  <!-- Unsplash Search Modal -->
  <dialog data-header-image-picker-target="unsplashModal"
          class="p-0 border-0 rounded">
    <div class="card shadow-sm" style="width: 800px; max-width: 90vw;">
      <div class="card-header d-flex justify-content-between align-items-center">
        <h5 class="m-0">Search Unsplash</h5>
        <button type="button"
                class="btn-close"
                data-action="header-image-picker#closeUnsplashModal">
        </button>
      </div>
      <div class="card-body">
        <input type="text"
               class="form-control mb-3"
               placeholder="Search for images..."
               data-header-image-picker-target="searchInput"
               data-action="input->header-image-picker#search">

        <div data-header-image-picker-target="loading"
             class="text-center mb-3"
             style="display: none;">
          <div class="spinner-border spinner-border-sm" role="status">
            <span class="visually-hidden">Loading...</span>
          </div>
        </div>

        <div data-header-image-picker-target="results"
             class="row g-3"
             style="max-height: 400px; overflow-y: auto;">
        </div>
      </div>
    </div>
  </dialog>

  <!-- Upload Modal -->
  <dialog data-header-image-picker-target="uploadModal"
          class="p-0 border-0 rounded">
    <div class="card shadow-sm" style="width: 500px; max-width: 90vw;">
      <div class="card-header d-flex justify-content-between align-items-center">
        <h5 class="m-0">Upload Image</h5>
        <button type="button"
                class="btn-close"
                data-action="header-image-picker#closeUploadModal">
        </button>
      </div>
      <div class="card-body">
        <input type="file"
               class="form-control"
               accept="image/*"
               data-header-image-picker-target="fileInput"
               data-action="change->header-image-picker#upload">
        <div class="form-text">Max file size: 25MB</div>
      </div>
    </div>
  </dialog>
</div>

<style>
  .header-preview {
    position: relative;
    border-radius: 6px;
    min-height: 60px;
    overflow: visible;
  }

  .header-preview-image {
    width: 100%;
    height: 240px;
    overflow: hidden;
    border-radius: 6px;
  }

  .header-preview-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .header-preview-emoji {
    position: absolute;
    bottom: -8px;
    left: 16px;
    font-size: 4rem;
    line-height: 1;
    background: none;
    border: none;
    padding: 0;
    cursor: pointer;
  }

  .header-preview-emoji:hover {
    transform: scale(1.1);
  }

  .header-preview:has(.header-preview-image[style*="display: none"]) {
    min-height: 60px;
  }

  .header-preview:has(.header-preview-image[style*="display: none"]) .header-preview-emoji {
    position: relative;
    bottom: auto;
    left: auto;
    margin: 8px 0;
  }

  .emoji-picker {
    position: absolute;
    top: 100%;
    left: 0;
    margin-top: 4px;
    background: var(--bs-body-bg, #fff);
    border: 1px solid rgba(0,0,0,0.15);
    border-radius: 8px;
    padding: 8px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    z-index: 1000;
    width: 100%;
    max-width: 500px;
  }

  @media (prefers-color-scheme: dark) {
    .emoji-picker {
      background: #2a2a2a;
      border-color: rgba(255,255,255,0.15);
    }
  }

  .emoji-picker-scroll {
    max-height: 280px;
    overflow-y: auto;
  }

  .emoji-category {
    margin-bottom: 8px;
  }

  .emoji-category-label {
    font-size: 0.7rem;
    font-weight: 600;
    color: #888;
    text-transform: uppercase;
    margin-bottom: 4px;
    padding-left: 2px;
  }

  .emoji-picker-grid {
    display: flex;
    flex-wrap: wrap;
    gap: 1px;
  }

  .emoji-option {
    background: none;
    border: none;
    padding: 3px;
    font-size: 1.25rem;
    line-height: 1;
    cursor: pointer;
    border-radius: 4px;
  }

  .emoji-option:hover {
    background-color: rgba(0, 0, 0, 0.1);
  }

  @media (prefers-color-scheme: dark) {
    .emoji-option:hover {
      background-color: rgba(255, 255, 255, 0.1);
    }
  }
</style>
