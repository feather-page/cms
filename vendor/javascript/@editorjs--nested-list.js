var r="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;var c={};!function(r,p){c=p()}(self,(function(){return(()=>{var c={384:(r,c,p)=>{p.d(c,{Z:()=>S});var m=p(645),g=p.n(m)()((function(r){return r[1]}));g.push([r.id,'.cdx-nested-list {\n  margin: 0;\n  padding: 0;\n  outline: none;\n  counter-reset: item;\n  list-style: none;\n}\n\n  .cdx-nested-list__item {\n    line-height: 1.6em;\n    display: flex;\n    margin: 2px 0;\n  }\n\n  .cdx-nested-list__item [contenteditable]{\n      outline: none;\n    }\n\n  .cdx-nested-list__item-body {\n      flex-grow: 2;\n    }\n\n  .cdx-nested-list__item-content,\n    .cdx-nested-list__item-children {\n      flex-basis: 100%;\n    }\n\n  .cdx-nested-list__item-content {\n      word-break: break-word;\n      white-space: pre-wrap;\n    }\n\n  .cdx-nested-list__item-children {}\n\n  .cdx-nested-list__item::before {\n      counter-increment: item;\n      margin-right: 5px;\n      white-space: nowrap;\n    }\n\n  .cdx-nested-list--ordered > .cdx-nested-list__item::before {\n    content: counters(item, ".") ". ";\n  }\n\n  .cdx-nested-list--unordered > .cdx-nested-list__item::before {\n    content: "â€¢";\n  }\n\n  .cdx-nested-list__settings {\n    display: flex;\n  }\n\n  .cdx-nested-list__settings .cdx-settings-button {\n      width: 50%;\n    }\n',""]);const S=g},645:c=>{c.exports=function(c){var p=[];return p.toString=function(){return this.map((function(r){var p=c(r);return r[2]?"@media ".concat(r[2]," {").concat(p,"}"):p})).join("")},p.i=function(c,m,g){"string"==typeof c&&(c=[[null,c,""]]);var S={};if(g)for(var v=0;v<(this||r).length;v++){var C=(this||r)[v][0];null!=C&&(S[C]=!0)}for(var y=0;y<c.length;y++){var w=[].concat(c[y]);g&&S[w[0]]||(m&&(w[2]?w[2]="".concat(m," and ").concat(w[2]):w[2]=m),p.push(w))}},p}},379:(r,c,p)=>{var m,g=function(){var r={};return function(c){if(void 0===r[c]){var p=document.querySelector(c);if(window.HTMLIFrameElement&&p instanceof window.HTMLIFrameElement)try{p=p.contentDocument.head}catch(r){p=null}r[c]=p}return r[c]}}(),S=[];function o(r){for(var c=-1,p=0;p<S.length;p++)if(S[p].identifier===r){c=p;break}return c}function a(r,c){for(var p={},m=[],g=0;g<r.length;g++){var v=r[g],C=c.base?v[0]+c.base:v[0],y=p[C]||0,w="".concat(C," ").concat(y);p[C]=y+1;var b=o(w),x={css:v[1],media:v[2],sourceMap:v[3]};-1!==b?(S[b].references++,S[b].updater(x)):S.push({identifier:w,updater:f(x,c),references:1}),m.push(w)}return m}function d(r){var c=document.createElement("style"),m=r.attributes||{};if(void 0===m.nonce){var S=p.nc;S&&(m.nonce=S)}if(Object.keys(m).forEach((function(r){c.setAttribute(r,m[r])})),"function"==typeof r.insert)r.insert(c);else{var v=g(r.insert||"head");if(!v)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");v.appendChild(c)}return c}var v,C=(v=[],function(r,c){return v[r]=c,v.filter(Boolean).join("\n")});function u(r,c,p,m){var g=p?"":m.media?"@media ".concat(m.media," {").concat(m.css,"}"):m.css;if(r.styleSheet)r.styleSheet.cssText=C(c,g);else{var S=document.createTextNode(g),v=r.childNodes;v[c]&&r.removeChild(v[c]),v.length?r.insertBefore(S,v[c]):r.appendChild(S)}}function h(r,c,p){var m=p.css,g=p.media,S=p.sourceMap;if(g?r.setAttribute("media",g):r.removeAttribute("media"),S&&"undefined"!=typeof btoa&&(m+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(S))))," */")),r.styleSheet)r.styleSheet.cssText=m;else{for(;r.firstChild;)r.removeChild(r.firstChild);r.appendChild(document.createTextNode(m))}}var y=null,w=0;function f(r,c){var p,m,g;if(c.singleton){var S=w++;p=y||(y=d(c)),m=u.bind(null,p,S,!1),g=u.bind(null,p,S,!0)}else p=d(c),m=h.bind(null,p,c),g=function(){!function(r){if(null===r.parentNode)return!1;r.parentNode.removeChild(r)}(p)};return m(r),function(c){if(c){if(c.css===r.css&&c.media===r.media&&c.sourceMap===r.sourceMap)return;m(r=c)}else g()}}r.exports=function(r,c){(c=c||{}).singleton||"boolean"==typeof c.singleton||(c.singleton=(void 0===m&&(m=Boolean(window&&document&&document.all&&!window.atob)),m));var p=a(r=r||[],c);return function(r){if(r=r||[],"[object Array]"===Object.prototype.toString.call(r)){for(var m=0;m<p.length;m++){var g=o(p[m]);S[g].references--}for(var v=a(r,c),C=0;C<p.length;C++){var y=o(p[C]);0===S[y].references&&(S[y].updater(),S.splice(y,1))}p=v}}}}},p={};function n(r){var m=p[r];if(void 0!==m)return m.exports;var g=p[r]={id:r,exports:{}};return c[r](g,g.exports,n),g.exports}n.n=r=>{var c=r&&r.__esModule?()=>r.default:()=>r;return n.d(c,{a:c}),c},n.d=(r,c)=>{for(var p in c)n.o(c,p)&&!n.o(r,p)&&Object.defineProperty(r,p,{enumerable:!0,get:c[p]})},n.o=(r,c)=>Object.prototype.hasOwnProperty.call(r,c);var m={};return(()=>{function e(r,c=null,p={}){const m=document.createElement(r);Array.isArray(c)?m.classList.add(...c):c&&m.classList.add(c);for(const r in p)m[r]=p[r];return m}function t(r){const c=e("div");return c.appendChild(r),c.innerHTML}function i(r){let c;return r.nodeType!==Node.ELEMENT_NODE?c=r.textContent:(c=r.innerHTML,c=c.replaceAll("<br>","")),0===c.trim().length}n.d(m,{default:()=>l});class s{constructor(){this.savedFakeCaret=void 0}save(){const r=s.range,c=e("span");c.hidden=!0,r.insertNode(c),this.savedFakeCaret=c}restore(){if(!this.savedFakeCaret)return;const r=window.getSelection(),c=new Range;c.setStartAfter(this.savedFakeCaret),c.setEndAfter(this.savedFakeCaret),r.removeAllRanges(),r.addRange(c),setTimeout((()=>{this.savedFakeCaret.remove()}),150)}static get range(){const r=window.getSelection();return r&&r.rangeCount?r.getRangeAt(0):null}static extractFragmentFromCaretPositionTillTheEnd(){const r=window.getSelection();if(!r.rangeCount)return;const c=r.getRangeAt(0);let p=c.startContainer;p.nodeType!==Node.ELEMENT_NODE&&(p=p.parentNode);const m=p.closest("[contenteditable]");c.deleteContents();const g=c.cloneRange();return g.selectNodeContents(m),g.setStart(c.endContainer,c.endOffset),g.extractContents()}static focus(r,c=!0){const p=document.createRange(),m=window.getSelection();p.selectNodeContents(r),p.collapse(c),m.removeAllRanges(),m.addRange(p)}static isAtStart(){const r=window.getSelection();if(r.focusOffset>0)return!1;const c=r.focusNode;return s.getHigherLevelSiblings(c,"left").every((r=>i(r)))}static getHigherLevelSiblings(r,c="left"){let p=r;const m=[];for(;p.parentNode&&"true"!==p.parentNode.contentEditable;)p=p.parentNode;const g="left"===c?"previousSibling":"nextSibling";for(;p[g];)p=p[g],m.push(p);return m}}const r='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><line x1="12" x2="19" y1="7" y2="7" stroke="currentColor" stroke-linecap="round" stroke-width="2"/><line x1="12" x2="19" y1="12" y2="12" stroke="currentColor" stroke-linecap="round" stroke-width="2"/><line x1="12" x2="19" y1="17" y2="17" stroke="currentColor" stroke-linecap="round" stroke-width="2"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M7.79999 14L7.79999 7.2135C7.79999 7.12872 7.7011 7.0824 7.63597 7.13668L4.79999 9.5"/></svg>';var c=n(379),p=n.n(c),g=n(384);p()(g.Z,{insert:"head",singleton:!1}),g.Z.locals;class l{static get isReadOnlySupported(){return!0}static get enableLineBreaks(){return!0}static get toolbox(){return{icon:r,title:"List"}}constructor({data:r,config:c,api:p,readOnly:m}){this.nodes={wrapper:null},this.api=p,this.readOnly=m,this.config=c,this.defaultListStyle="ordered"===this.config.defaultStyle?"ordered":"unordered";const g={style:this.defaultListStyle,items:[]};this.data=r&&Object.keys(r).length?r:g,this.caret=new s}render(){return this.nodes.wrapper=this.makeListWrapper(this.data.style,[this.CSS.baseBlock]),this.data.items.length?this.appendItems(this.data.items,this.nodes.wrapper):this.appendItems([{content:"",items:[]}],this.nodes.wrapper),this.readOnly||this.nodes.wrapper.addEventListener("keydown",(r=>{switch(r.key){case"Enter":this.enterPressed(r);break;case"Backspace":this.backspace(r);break;case"Tab":r.shiftKey?this.shiftTab(r):this.addTab(r)}}),!1),this.nodes.wrapper}renderSettings(){return[{name:"unordered",label:this.api.i18n.t("Unordered"),icon:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><line x1="9" x2="19" y1="7" y2="7" stroke="currentColor" stroke-linecap="round" stroke-width="2"/><line x1="9" x2="19" y1="12" y2="12" stroke="currentColor" stroke-linecap="round" stroke-width="2"/><line x1="9" x2="19" y1="17" y2="17" stroke="currentColor" stroke-linecap="round" stroke-width="2"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M5.00001 17H4.99002"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M5.00001 12H4.99002"/><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M5.00001 7H4.99002"/></svg>'},{name:"ordered",label:this.api.i18n.t("Ordered"),icon:r}].map((r=>({name:r.name,icon:r.icon,label:r.label,isActive:this.data.style===r.name,closeOnActivate:!0,onActivate:()=>{this.listStyle=r.name}})))}static get pasteConfig(){return{tags:["OL","UL","LI"]}}onPaste(r){const c=r.detail.data;this.data=this.pasteHandler(c);const p=this.nodes.wrapper;p&&p.parentNode.replaceChild(this.render(),p)}pasteHandler(r){const{tagName:c}=r;let p,m;switch(c){case"OL":p="ordered",m="ol";break;case"UL":case"LI":p="unordered",m="ul"}const g={style:p,items:[]},s=r=>Array.from(r.querySelectorAll(":scope > li")).map((r=>{const c=r.querySelector(`:scope > ${m}`),p=c?s(c):[];return{content:r?.firstChild?.textContent||"",items:p}}));return g.items=s(r),g}appendItems(r,c){r.forEach((r=>{const p=this.createItem(r.content,r.items);c.appendChild(p)}))}createItem(r,c=[]){const p=e("li",this.CSS.item),m=e("div",this.CSS.itemBody),g=e("div",this.CSS.itemContent,{innerHTML:r,contentEditable:!this.readOnly});return m.appendChild(g),p.appendChild(m),c&&c.length>0&&this.addChildrenList(p,c),p}save(){const e=r=>Array.from(r.querySelectorAll(`:scope > .${this.CSS.item}`)).map((r=>{const c=r.querySelector(`.${this.CSS.itemChildren}`);return{content:this.getItemContent(r),items:c?e(c):[]}}));return{style:this.data.style,items:e(this.nodes.wrapper)}}addChildrenList(r,c){const p=r.querySelector(`.${this.CSS.itemBody}`),m=this.makeListWrapper(void 0,[this.CSS.itemChildren]);this.appendItems(c,m),p.appendChild(m)}makeListWrapper(r=this.listStyle,c=[]){const p="ordered"===r?"ol":"ul",m="ordered"===r?this.CSS.wrapperOrdered:this.CSS.wrapperUnordered;return c.push(m),e(p,[this.CSS.wrapper,...c])}get CSS(){return{baseBlock:this.api.styles.block,wrapper:"cdx-nested-list",wrapperOrdered:"cdx-nested-list--ordered",wrapperUnordered:"cdx-nested-list--unordered",item:"cdx-nested-list__item",itemBody:"cdx-nested-list__item-body",itemContent:"cdx-nested-list__item-content",itemChildren:"cdx-nested-list__item-children",settingsWrapper:"cdx-nested-list__settings",settingsButton:this.api.styles.settingsButton,settingsButtonActive:this.api.styles.settingsButtonActive}}get listStyle(){return this.data.style||this.defaultListStyle}set listStyle(r){const c=Array.from(this.nodes.wrapper.querySelectorAll(`.${this.CSS.wrapper}`));c.push(this.nodes.wrapper),c.forEach((c=>{c.classList.toggle(this.CSS.wrapperUnordered,"unordered"===r),c.classList.toggle(this.CSS.wrapperOrdered,"ordered"===r)})),this.data.style=r}get currentItem(){let r=window.getSelection().anchorNode;return r.nodeType!==Node.ELEMENT_NODE&&(r=r.parentNode),r.closest(`.${this.CSS.item}`)}enterPressed(r){const c=this.currentItem;r.stopPropagation(),r.preventDefault();const p=0===this.getItemContent(c).trim().length,m=c.parentNode===this.nodes.wrapper,g=null===c.nextElementSibling;if(m&&g&&p)return void this.getOutOfList();if(g&&p)return void this.unshiftItem();const S=t(s.extractFragmentFromCaretPositionTillTheEnd()),v=c.querySelector(`.${this.CSS.itemChildren}`),C=this.createItem(S,void 0);v&&Array.from(v.querySelectorAll(`.${this.CSS.item}`)).length>0?v.prepend(C):c.after(C),this.focusItem(C)}unshiftItem(){const r=this.currentItem,c=r.parentNode.closest(`.${this.CSS.item}`);if(!c)return;this.caret.save(),c.after(r),this.caret.restore();const p=c.querySelector(`.${this.CSS.itemChildren}`);0===p.children.length&&p.remove()}getItemContent(r){const c=r.querySelector(`.${this.CSS.itemContent}`);return i(c)?"":c.innerHTML}focusItem(r,c=!0){const p=r.querySelector(`.${this.CSS.itemContent}`);s.focus(p,c)}getOutOfList(){this.currentItem.remove(),this.api.blocks.insert(),this.api.caret.setToBlock(this.api.blocks.getCurrentBlockIndex())}backspace(r){if(!s.isAtStart())return;r.preventDefault();const c=this.currentItem,p=c.previousSibling,m=c.parentNode.closest(`.${this.CSS.item}`);if(!p&&!m)return;let g;if(r.stopPropagation(),p){const r=p.querySelectorAll(`.${this.CSS.item}`);g=Array.from(r).pop()||p}else g=m;const S=t(s.extractFragmentFromCaretPositionTillTheEnd()),v=g.querySelector(`.${this.CSS.itemContent}`);s.focus(v,!1),this.caret.save(),v.insertAdjacentHTML("beforeend",S);let C=c.querySelectorAll(`.${this.CSS.itemChildren} > .${this.CSS.item}`);C=Array.from(C),C=C.filter((r=>r.parentNode.closest(`.${this.CSS.item}`)===c)),C.reverse().forEach((r=>{p?g.after(r):c.after(r)})),c.remove(),this.caret.restore()}addTab(r){r.stopPropagation(),r.preventDefault();const c=this.currentItem,p=c.previousSibling;if(!p)return;const m=p.querySelector(`.${this.CSS.itemChildren}`);if(this.caret.save(),m)m.appendChild(c);else{const r=this.makeListWrapper(void 0,[this.CSS.itemChildren]),m=p.querySelector(`.${this.CSS.itemBody}`);r.appendChild(c),m.appendChild(r)}this.caret.restore()}shiftTab(r){r.stopPropagation(),r.preventDefault(),this.unshiftItem()}static joinRecursive(r){return r.items.map((r=>`${r.content} ${l.joinRecursive(r)}`)).join("")}static get conversionConfig(){return{export:r=>l.joinRecursive(r),import:r=>({items:[{content:r,items:[]}],style:"unordered"})}}}})(),m.default})()}));var p=c;const m=c.NestedList;export{m as NestedList,p as default};

